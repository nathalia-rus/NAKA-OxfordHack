<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="icon" href="../../../../favicon.ico">

        <title>NAKA</title>

        <link href="static/css/bootstrap.css" rel="stylesheet">
        <link href="static/css/starter-template.css" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="style.css">
        <script type="text/javascript">
            $(document).ready(function() {});
        </script>
        <script src="jQuery.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Nunito:300,400" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">


        <h1 class="banner "><span class="bigtitle"> NAKA </span>
            <span class="smalltitle"> WELCOME, DR SMITH. 
                <br> 
                PATIENT: 0567878956
            </span>
            <span class="menu">

                NEXT PATIENT
                <br>
                LOG OFF

            </span>

        </h1>

    </head>
    <br>
    <br>
    <br>

    <body>
        <main role="main">

            <!-- Hidden config table -->
            <table  style="display:none;" id="settings" width="100%">
                <tr>
                    <td></td>
                    <td>
                        <h1 style="font-weight:500;">Speech Recognition</h1>
                        <h2 style="font-weight:500;">Microsoft Cognitive Services</h2>
                    </td>
                </tr>
                <tr>
                    <td align="right"><a href="https://www.microsoft.com/cognitive-services/en-us/sign-up" target="_blank">Subscription</a>:</td>
                    <td><input id="key" type="text" size="40" value="57311ec19665421e9456f8db9b01d7ca"></td>
                </tr>
                <tr>
                    <td align="right">Language:</td>
                    <td align="left">
                        <select id="languageOptions">
                            <option value="zh-CN">Chinese - CN</option>
                            <option value="en-GB">English - GB</option>
                            <option value="en-US" selected="selected">English - US</option>
                            <option value="fr-FR">French - FR</option>
                            <option value="de-DE">German - DE</option>
                            <option value="it-IT">Italian - IT</option>
                            <option value="es-ES">Spanish - ES</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td align="right">Recognition Mode:</td>
                    <td align="left">
                        <select id="recognitionMode">
                            <option value="Interactive">Interactive</option>
                            <option value="Conversation">Conversation</option>
                            <option value="Dictation">Dictation</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td align="right">Format:</td>
                    <td align="left">
                        <select id="formatOptions">
                            <option value="Simple" selected="selected">Simple Result</option>
                            <option value="Detailed">Detailed Result</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td align="right">Input:</td>
                    <td align="left">
                        <select id="inputSource">
                            <option value="Mic" selected="selected">Microphone</option>
                            <option value="File">Audio File</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <button id="startBtn" disabled="disabled">Start</button>
                        <button id="stopBtn" disabled="disabled">Stop</button>
                        <input type="file" id="filePicker" accept=".wav" style="display:none" />
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <table>
                            <tr>
                                <td>Results:</td>
                                <td>Current hypothesis:</td>
                            </tr>
                            <tr>
                                <td>
                                    <textarea id="phraseDiv" style="display: inline-block;width:500px;height:200px"></textarea>
                                </td>
                                <td style="vertical-align: top">
                                    <span id="hypothesisDiv" style="width:200px;height:200px;display:block;"></span>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td align="right">Status:</td>
                    <td align="left"><span id="statusDiv"></span></td>
                </tr>
            </table>
            <!-- End of hidden config table -->

            <div class="container">

                <p>


                <div class="legend_space">
                    <form name="message" action="">
                        <button type="button" id="beginNAKA" value="Send" class="legend"> RECORD </button>
                        <button type="button" id="stopNAKA" value="Send" class="legend"> PAUSE </button>

                    </form>
                    <span class=" legend legend_conclusion">
                        CONCLUSION
                    </span>
                </div>

                <div class=" box_conclusion">
                    <div class="text">


                        Next step: using TPP's API, we would display here the most accurate details of the final diagnose, with the description and explanation of the disease. <br/><br/> Ex: "Parkinson's disease is a disorder that affects nerve cells, or neurons, in a part of the brain that controls muscle movement. In Parkinson's, neurons that make a chemical called dopamine die or do not work properly. Dopamine normally sends signals that help coordinate your movements. No one knows what damages these cells. Symptoms of Parkinson's disease may include</p> <ul> <li>Trembling of hands, arms, legs, jaw and face </li> <li>Stiffness of the arms, legs and trunk </li> <li>Slowness of movement </li> <li>Poor balance and coordination </li> </ul> <p>As symptoms get worse, people with the disease may have trouble walking, talking or doing simple tasks. They may also have problems such as depression, sleep problems or trouble chewing, swallowing or speaking. </p> <p>Parkinson's usually begins around age 60, but it can start earlier. It is more common in men than in women. There is no cure for Parkinson's disease. A variety of medicines sometimes help symptoms dramatically."
                    </div>

                </div>

                <div class=" box_speech">
                    <div class="text">
                        <div id="speach"></div>
                    </div>

                </div>

                <span class=" legend legend_conclusion">
                    PAPERS

                </span>

                <div class=" box_papers">
                    <span class="title_papers_top literature" id="paper_1" number="0"> <p ></p> </span>
                    <span class="title_papers_top literature" id="paper_2" number="1"> <p></p> </span>
                    <span class="title_papers_top literature" id="paper_3" number="2"> <p></p> </span>
                    <span class="title_papers_bottom literature" id="paper_4" number="3"> <p>Title</p> </span>
                    <span class="title_papers_bottom literature" id="paper_5" number="4"> <p>Title</p> </span>
                    <span class="title_papers_bottom literature" id="paper_6" number="5"> <p>Title</p> </span>
                </div>





                <div class=" legend legend_space">

                    SYMPTOMS

                </div>


                <div class=" box_symptoms">
                    <div class="text">
                        <div id="symptoms"></div>
                    </div>

                </div>

                <div class=" legend legend_space">

                    YOUR NOTES (conclusions, prescription ideasâ€¦)

                </div>



                <div class=" box_notes">
                    <div class="text">


                    </div>


                    <div class="text_action legend_space">
                        <form name="message" action="">
                            <input name="usertext" type="text" id="usertext" class="box_notebook" placeholder="Write your thoughts here..." />
                            <br>
                            <button type="button" id="submittext" value="Send" class="legend"> SAVE </button>
                        </form>
                    </div>



                </div>

                <div class="legend_space">
<!--                    <form name="message" action="">-->
                        <input name="usertext" type="text" id="keyconclusion" class="legend" ; placeholder="Look for your conclusion here..." />


                        <button type="button" id="submitkeyconclusion" value="Send" class="legend"> Search </button>
<!--                    </form>-->
                </div>


                </p>






            </div>
        
        
                    <!--            Modal data-->
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document" style="width:1250px;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body" id='exampleModalBody'>
                            ...
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <a target="_blank" class="btn btn-primary" id="ModalLinkArticle" href="#" role="button">Full Article</a>
                        </div>
                    </div>
                </div>
            </div>
        
        </main>
    </body>






<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
<script src="static/js/popper.min.js"></script>
<script src="static/js/bootstrap.min.js"></script>

<!-- The SDK has a dependency on requirejs (http://requirejs.org/). -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.3/require.min.js"></script>

<!-- SDK REFERENCE -->
<script src="distrib/speech.browser.sdk.js"></script>

<!-- Generated list of symptoms -->
<script src="static/js/symptoms.js"></script>
<script>
    // Array containing all mentioned symptoms
    var mentioned_symptoms = [];

    // Generating badges for different diseases with different bootstrap class names
    function buildBadge(title, i) {
        var n = i % class_styles.length;    
        return '<span class="badge badge-'+class_styles[n]+'"><h5>'+title+'</h5></span> ';
    }

    var output = 0;

    function updateSuggestions(out, disease) {
        test = 2;
        /* Number of entries to return */
        var RETURN_ENTRIES = 6;
        /* Earliest publication data */
        var MIN_YEAR = 2010;
        /* Latest publication date */
        var MAX_YEAR = 2017;

        var lookuplist = "";
        for(var i=0; i<mentioned_symptoms.length; i++) {
            lookuplist = mentioned_symptoms[i] + "," + lookuplist;
        }

        console.log(lookuplist);

        /*
                Call Mendeley API to obtain relevent research articles
            */
        $.get( "mendeley/curl.php", { number: RETURN_ENTRIES, words: disease, miny: "2010", maxy: "2017" } )
            .done(function( data ) {
            //console.log(data);
            output = JSON.parse(data);
            out = output;

            for(var i=0; i < output.length; i++) {
                //$("#temp").append(output[i]['title'] + "<br><br> ");
                console.log(i + " " + output[i]['title']);
            }


            $( ".literature" ).each(function( index ) {
                //$(".card-title").eq(index).text(output[index]['title']);
                //$(this).fadeOut();
                $(".literature span").eq(index).text(output[index]['title']);
                console.log( index + ": " + $( this ).text() );
            });

            $("#paper_1").html('<a href="javascript:;" id="paper_1" number="0">'+output[0]['title']+'</a>');
            $("#paper_2").html('<a href="javascript:;" id="paper_2" number="1">'+output[1]['title']+'</a>');
            $("#paper_3").html('<a href="javascript:;" id="paper_3" number="2">'+output[2]['title']+'</a>');
            $("#paper_4").html('<a href="javascript:;" id="paper_4" number="3">'+output[3]['title']+'</a>');
            $("#paper_5").html('<a href="javascript:;" id="paper_5" number="4">'+output[4]['title']+'</a>');
            $("#paper_6").html('<a href="javascript:;" id="paper_6" number="5">'+output[5]['title']+'</a>');

        });
    }
</script>

<!-- SDK USAGE -->
<script src="static/js/microsoft-sdk-action.js"></script>

<script>
    $("#suggestedLit").hide();

    $(".literature").click(function(){
        //alert($(this).attr("number"));
        var id = $(this).attr("number");
        console.log(output[id]['title']);
        $("#exampleModalLabel").text(output[id].title);
        $("#exampleModalBody").text(output[id].abstract);
        $("#ModalLinkArticle").attr("href", output[id].link);
        $("#exampleModal").modal();

    });
</script>

<script>
    var disease = "";

    $("#beginNAKA").click(function() {
        if (isListening == false)
            $("#startBtn").click();
    });

    $("#stopNAKA").click(function() {
        $("#stopBtn").click();
    });

    $("#submitkeyconclusion").click(function(){
        disease = $("#keyconclusion").val();
        updateSuggestions(output, disease);
    });
</script>

</html>